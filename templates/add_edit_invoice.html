{# templates/add_edit_invoice.html #}
{# Plantilla para el formulario de añadir o editar facturas. #}

{% extends "layout.html" %}

{% block title %}
    {% if invoice %}
        Editar Factura: {{ invoice.invoice_number }} - MotoShop
    {% else %}
        Añadir Nueva Factura - MotoShop
    {% endif %}
{% endblock %}

{% block content %}
<section class="form-section container">
    <div class="form-container">
        <h1>
            {% if invoice %}
                Editar Factura: {{ invoice.invoice_number }}
            {% else %}
                Añadir Nueva Factura
            {% endif %}
        </h1>

        <form method="POST">
            {{ form.csrf_token }}

            <div class="form-group">
                {{ form.customer_name.label }}
                {{ form.customer_name(class_="form-control") }}
                {% if form.customer_name.errors %}
                    <div class="help-block">
                        {% for error in form.customer_name.errors %}
                            <span>{{ error }}</span>
                        {% endfor %}
                    </div>
                {% endif %}
            </div>

            <div class="form-group">
                {{ form.customer_address.label }}
                {{ form.customer_address(class_="form-control", rows="3") }}
                {% if form.customer_address.errors %}
                    <div class="help-block">
                        {% for error in form.customer_address.errors %}
                            <span>{{ error }}</span>
                        {% endfor %}
                    </div>
                {% endif %}
            </div>

            <div class="form-group">
                {{ form.customer_email.label }}
                {{ form.customer_email(class_="form-control") }}
                {% if form.customer_email.errors %}
                    <div class="help-block">
                        {% for error in form.customer_email.errors %}
                            <span>{{ error }}</span>
                        {% endfor %}
                    </div>
                {% endif %}
            </div>

            <div class="form-group">
                {{ form.invoice_date.label }}
                {{ form.invoice_date(class_="form-control", type="date") }}
                {% if form.invoice_date.errors %}
                    <div class="help-block">
                        {% for error in form.invoice_date.errors %}
                            <span>{{ error }}</span>
                        {% endfor %}
                    </div>
                {% endif %}
            </div>

            <div class="form-group">
                {{ form.items_description.label }}
                {{ form.items_description(class_="form-control", rows="5") }}
                {% if form.items_description.errors %}
                    <div class="help-block">
                        {% for error in form.items_description.errors %}
                            <span>{{ error }}</span>
                        {% endfor %}
                    </div>
                {% endif %}
            </div>

            <div class="form-group">
                {{ form.subtotal_amount.label }}
                {{ form.subtotal_amount(class_="form-control", type="number", step="0.01") }}
                {% if form.subtotal_amount.errors %}
                    <div class="help-block">
                        {% for error in form.subtotal_amount.errors %}
                            <span>{{ error }}</span>
                        {% endfor %}
                    </div>
                {% endif %}
            </div>

            <div class="form-group">
                {{ form.tax_rate.label }}
                {{ form.tax_rate(class_="form-control", type="number", step="0.01") }}
                {% if form.tax_rate.errors %}
                    <div class="help-block">
                        {% for error in form.tax_rate.errors %}
                            <span>{{ error }}</span>
                        {% endfor %}
                    </div>
                {% endif %}
            </div>

            <div class="form-group">
                {{ form.tax_amount.label }}
                {{ form.tax_amount(class_="form-control", type="number", step="0.01") }}
                {% if form.tax_amount.errors %}
                    <div class="help-block">
                        {% for error in form.tax_amount.errors %}
                            <span>{{ error }}</span>
                        {% endfor %}
                    </div>
                {% endif %}
            </div>

            <div class="form-group">
                {{ form.total_amount.label }}
                {{ form.total_amount(class_="form-control", type="number", step="0.01") }}
                {% if form.total_amount.errors %}
                    <div class="help-block">
                        {% for error in form.total_amount.errors %}
                            <span>{{ error }}</span>
                        {% endfor %}
                    </div>
                {% endif %}
            </div>

            <div class="form-group">
                {{ form.notes.label }}
                {{ form.notes(class_="form-control", rows="3") }}
                {% if form.notes.errors %}
                    <div class="help-block">
                        {% for error in form.notes.errors %}
                            <span>{{ error }}</span>
                        {% endfor %}
                    </div>
                {% endif %}
            </div>

            {{ form.submit(class_="btn submit-btn") }}
        </form>
        <div class="mt-3 text-center">
            <a href="{{ url_for('invoices_bp.admin_invoices') }}" class="btn btn-secondary">Volver a Facturas</a>
        </div>
    </div>
</section>
{% endblock %}